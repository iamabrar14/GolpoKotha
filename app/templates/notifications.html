{% extends "base.html" %}
{% block body %}
  <h1>üîî Notifications</h1>
  
  {% if notifications %}
    <div class="notification-actions" style="margin-bottom: 15px;">
      <form action="{{ url_for('main.mark_all_notifications_read') }}" method="post" style="display:inline;">
        <button type="submit" class="btn">Mark All as Read</button>
      </form>
      <form action="{{ url_for('main.clear_all_notifications') }}" method="post" style="display:inline; margin-left:10px;" onsubmit="return confirm('Are you sure you want to delete all notifications?');">
        <button type="submit" class="btn danger">Clear All</button>
      </form>
    </div>
    
    {% for notification in notifications %}
      <article class="card notification-item {% if not notification.is_read %}unread{% endif %}" style="margin:12px 0; position:relative;">
        {% if notification.notification_type == 'like' %}
          <span style="font-size:1.5em;">‚ù§Ô∏è</span>
        {% elif notification.notification_type == 'comment' %}
          <span style="font-size:1.5em;">üí¨</span>
        {% elif notification.notification_type == 'follow' %}
          <span style="font-size:1.5em;">üë§</span>
        {% elif notification.notification_type == 'new_post' %}
          <span style="font-size:1.5em;">üìù</span>
        {% endif %}
        
        <div style="margin-left:40px;">
          <p style="margin:5px 0;">{{ notification.message }}</p>
          <div class="post-meta">{{ notification.created_at.strftime('%Y-%m-%d %H:%M') }}</div>
          
          <div class="post-actions" style="margin-top:10px;">
            {% if notification.link %}
              <form action="{{ url_for('main.mark_one_notification_read', notification_id=notification.id) }}" method="post" style="display:inline;">
                <button type="submit" class="btn muted">View</button>
              </form>
            {% endif %}
            <form action="{{ url_for('main.delete_notification', notification_id=notification.id) }}" method="post" style="display:inline; margin-left:10px;" onsubmit="return confirm('Delete this notification?');">
              <button type="submit" class="btn danger">Delete</button>
            </form>
          </div>
        </div>
        
        {% if not notification.is_read %}
          <span style="position:absolute; top:10px; right:10px; width:10px; height:10px; background:#ff4444; border-radius:50%;"></span>
        {% endif %}
      </article>
    {% endfor %}
    
    {% if p %}
    <div class="pagination">
      {% if p.has_prev %}
        <a href="{{ request.path }}?page={{ p.prev_num }}">&laquo; Prev</a>
      {% else %}
        <span>Start</span>
      {% endif %}
      {% for num in range(1, p.pages + 1) %}
        {% if num == p.page %}
          <span class="active">{{ num }}</span>
        {% else %}
          <a href="{{ request.path }}?page={{ num }}">{{ num }}</a>
        {% endif %}
      {% endfor %}
      {% if p.has_next %}
        <a href="{{ request.path }}?page={{ p.next_num }}">Next &raquo;</a>
      {% else %}
        <span>End</span>
      {% endif %}
    </div>
    {% endif %}
  {% else %}
    <div class="card" style="text-align:center; padding:40px;">
      <p style="font-size:3em; margin:0;">üîî</p>
      <h3 style="margin:10px 0;">No notifications yet</h3>
      <p class="post-meta">When someone likes, comments, or follows you, you'll see it here!</p>
    </div>
  {% endif %}
{% endblock %}
