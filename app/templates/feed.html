{% extends "base.html" %}
{% block body %}
  <div class="card">
    <h2>My Feed</h2>
    <p>Posts from users you follow</p>
  </div>
  
  {% if posts %}
    {% for post in posts %}
      <article class="card" style="margin:14px 0;">
        <h3><a href="{{ url_for('main.post_detail', post_id=post.id) }}" style="color:#fff; text-decoration:none">{{ post.title }}</a></h3>
        <div class="post-meta">
          by <a href="{{ url_for('main.profile', username=post.author.username) }}" style="color:#4a9eff;">{{ post.author.username }}</a> 
          on {{ post.date_posted.strftime('%Y-%m-%d') }}
        </div>
        <p>{{ post.content | truncate(220) }}</p>
        <div class="post-actions">
          <a class="btn outline" href="{{ url_for('main.post_detail', post_id=post.id) }}">Read</a>
          <span style="margin-left:10px; color:#999;">üëÅÔ∏è {{ post.views or 0 }} views | ‚ù§Ô∏è {{ post.likes or 0 }} likes</span>
        </div>
      </article>
    {% endfor %}
  {% else %}
    <div class="card">
      <p>No posts yet from users you follow. Start following users to see their posts here!</p>
      <a href="{{ url_for('main.home') }}" class="btn">Explore Posts</a>
    </div>
  {% endif %}
  
  {% if p %}
  <div class="pagination">
    {% if p.has_prev %}
      <a href="{{ request.path }}?page={{ p.prev_num }}">&laquo; Prev</a>
    {% else %}
      <span>Start</span>
    {% endif %}
    {% for num in range(1, p.pages + 1) %}
      {% if num == p.page %}
        <span class="active">{{ num }}</span>
      {% else %}
        <a href="{{ request.path }}?page={{ num }}">{{ num }}</a>
      {% endif %}
    {% endfor %}
    {% if p.has_next %}
      <a href="{{ request.path }}?page={{ p.next_num }}">Next &raquo;</a>
    {% else %}
      <span>End</span>
    {% endif %}
  </div>
  {% endif %}
{% endblock %}
